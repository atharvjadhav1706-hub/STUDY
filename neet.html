<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEET 2026 Royal Glass V24</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            /* SAKURA LIGHT THEME */
            --bg-color: #fff0f5;
            --glass-surface: rgba(255, 255, 255, 0.65);
            --glass-border: rgba(255, 255, 255, 0.8);
            --text-main: #2d3436; /* Dark Charcoal */
            --text-sub: #636e72;  /* Soft Grey */
            
            /* VIBRANT ACCENTS */
            --phy: #0984e3; /* Blue */
            --chem: #fdcb6e; /* Mustard/Gold */
            --bio: #e84393; /* Pink */
            --success: #00b894;
            --danger: #d63031;
            
            --shadow: 0 10px 30px rgba(232, 67, 147, 0.15);
            --font-stack: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }

        * { box-sizing: border-box; font-family: var(--font-stack); -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0; padding: 20px; padding-bottom: 100px;
            background-color: var(--bg-color);
            background-image: linear-gradient(135deg, #fff0f5 0%, #ffe3e3 100%);
            color: var(--text-main);
            min-height: 100vh;
        }

        .container { max-width: 600px; margin: 0 auto; }

        /* --- HEADER --- */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .app-title {
            background: transparent; border: none; color: var(--text-main);
            font-size: 1.3rem; font-weight: 800; letter-spacing: -0.5px;
            width: 60%; outline: none; padding: 5px 0; text-transform: uppercase;
            
            text-decoration: underline;
            text-decoration-color: rgba(232, 67, 147, 0.4);
            text-decoration-thickness: 3px;
            text-underline-offset: 4px;
        }
        
        .header-actions { display: flex; align-items: center; gap: 15px; }
        
        .streak-pill { 
            background: rgba(253, 203, 110, 0.2); border: 1px solid rgba(253, 203, 110, 0.6);
            color: #d35400; padding: 6px 14px; border-radius: 20px; font-weight: 800; font-size: 0.85rem;
            white-space: nowrap; box-shadow: 0 4px 10px rgba(253, 203, 110, 0.2);
        }
        
        .menu-btn {
            font-size: 1.6rem; cursor: pointer; color: var(--text-main);
            width: 44px; height: 44px; display: grid; place-items: center;
            border-radius: 50%; background: white; box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            transition: 0.2s;
        }
        .menu-btn:active { transform: scale(0.95); }

        /* --- SETTINGS MODAL --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.6); backdrop-filter: blur(8px);
            z-index: 1000; display: none; align-items: center; justify-content: center;
        }
        .modal-overlay.open { display: flex; animation: fadeIn 0.2s; }
        
        .modal-box {
            background: white; border: 1px solid rgba(0,0,0,0.05);
            border-radius: 24px; padding: 30px; width: 85%; max-width: 350px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
        }
        .modal-title { font-size: 1.2rem; font-weight: 800; margin-bottom: 20px; text-align: center; }
        .setting-label { display: block; font-size: 0.75rem; color: var(--text-sub); margin-bottom: 10px; font-weight: 700; letter-spacing: 1px; }
        .limit-input {
            width: 100px; padding: 12px; background: #f5f6fa; border: 1px solid #dcdde1;
            color: var(--text-main); border-radius: 14px; font-size: 1.5rem; text-align: center; font-weight: 700;
        }
        .btn-close {
            width: 100%; padding: 15px; background: #f1f2f6; color: var(--text-main); 
            border: none; border-radius: 14px; font-weight: 800; cursor: pointer; margin-top: 15px;
        }

        /* --- COUNTDOWN (DARK PURPLE GLASS) --- */
        .countdown {
            /* Dark Purple Gradient Background */
            background: linear-gradient(135deg, rgba(76, 29, 149, 0.9) 0%, rgba(124, 58, 237, 0.85) 100%);
            backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-top: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 28px; padding: 25px; margin-bottom: 35px;
            text-align: center; position: relative; overflow: hidden;
            box-shadow: 0 20px 50px -10px rgba(124, 58, 237, 0.4);
            color: white;
        }
        
        .timer-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-top: 15px; }
        
        /* 4 White Glass Boxes */
        .t-box {
            background: rgba(255, 255, 255, 0.15); /* Milky White Glass */
            backdrop-filter: blur(10px);
            padding: 12px 5px; border-radius: 18px; 
            border: 1px solid rgba(255, 255, 255, 0.25);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .t-val { font-size: 1.6rem; font-weight: 800; display: block; color: #ffffff; text-shadow: 0 2px 10px rgba(0,0,0,0.2); line-height: 1.1; }
        .t-lbl { font-size: 0.65rem; color: rgba(255,255,255,0.8); text-transform: uppercase; font-weight: 700; letter-spacing: 1px; margin-top: 4px; }

        /* --- PROGRESS BARS --- */
        .prog-container { margin-bottom: 30px; }
        .prog-header { display: flex; justify-content: space-between; font-size: 0.75rem; margin-bottom: 8px; color: var(--text-sub); font-weight: 700; text-transform: uppercase; letter-spacing: 1px; }
        .bar-track { height: 12px; background: rgba(0,0,0,0.05); border-radius: 20px; overflow: hidden; }
        .bar-fill { height: 100%; width: 0%; border-radius: 20px; transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .grad-global { background: linear-gradient(90deg, #a29bfe, #6c5ce7); }
        .grad-phy { background: var(--phy); } .grad-chem { background: var(--chem); } .grad-bio { background: var(--bio); }

        /* --- PCB GRID --- */
        .pcb-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 35px; }
        .subject-card {
            background: var(--glass-surface); border: 1px solid white;
            border-radius: 22px; padding: 22px; position: relative; overflow: hidden; cursor: pointer;
            display: flex; flex-direction: column; justify-content: space-between; min-height: 140px;
            box-shadow: var(--shadow); transition: 0.2s;
        }
        .subject-card:active { transform: scale(0.98); }
        .subject-card::after { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 6px; }
        .card-phy::after { background: var(--phy); } .card-chem::after { background: var(--chem); } .card-bio::after { background: var(--bio); }

        .sub-icon { font-size: 2.2rem; margin-bottom: 8px; }
        .sub-title { font-weight: 800; font-size: 1.1rem; color: var(--text-main); letter-spacing: 0.5px; }
        .full-width { grid-column: span 2; flex-direction: row; align-items: center; min-height: 100px; padding-right: 25px; }
        .tab-prog-track { height: 6px; background: rgba(0,0,0,0.05); margin-top: 12px; border-radius: 10px; overflow: hidden; }

        /* --- LISTS --- */
        .list-header { font-size: 0.8rem; font-weight: 800; color: var(--text-sub); text-transform: uppercase; margin: 30px 0 15px 5px; letter-spacing: 1.5px; }
        .task-item {
            display: flex; align-items: center; justify-content: space-between;
            background: white; padding: 18px; border-radius: 18px; 
            margin-bottom: 12px; border: 1px solid rgba(0,0,0,0.03);
            box-shadow: 0 4px 15px rgba(0,0,0,0.03); transition: 0.2s;
        }
        .checkbox {
            width: 28px; height: 28px; border: 2px solid #dfe6e9; border-radius: 10px;
            cursor: pointer; display: grid; place-items: center; flex-shrink: 0; margin-right: 18px;
            transition: 0.3s; background: #f5f6fa;
        }
        .checkbox.checked { background: var(--success); border-color: var(--success); box-shadow: 0 0 15px rgba(0, 184, 148, 0.4); }
        .checkbox.checked::after { content: '‚úì'; color: white; font-weight: 900; font-size: 16px; }

        .play-link {
            text-decoration: none; width: 34px; height: 34px; border-radius: 50%;
            background: #f1f2f6; color: var(--phy);
            display: grid; place-items: center; font-size: 0.8rem; margin-left: 10px;
        }

        .tag { font-size: 0.65rem; padding: 5px 10px; border-radius: 8px; font-weight: 700; margin-left: 8px; background: #f1f2f6; color: #636e72; }
        .tag-high { color: var(--danger); background: rgba(214, 48, 49, 0.1); }
        .tag-fast { color: var(--success); background: rgba(0, 184, 148, 0.1); }

        /* --- INPUTS --- */
        .input-label { font-size: 0.7rem; color: var(--text-sub); font-weight: 700; margin-bottom: 6px; display: block; letter-spacing: 0.8px; }
        select, input[type="text"], input[type="date"] { 
            width: 100%; padding: 16px; background: white; border: 1px solid #dfe6e9; 
            color: var(--text-main); border-radius: 16px; outline: none; font-size: 1rem; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.02);
        }

        .widget-row { display: grid; grid-template-columns: 1fr 1.2fr; gap: 12px; margin-bottom: 15px; }
        .timer-container {
            display: flex; align-items: center; background: white; border: 1px solid #dfe6e9;
            border-radius: 16px; padding: 5px; height: 56px; box-shadow: 0 4px 10px rgba(0,0,0,0.02);
        }
        .timer-part { flex: 1; text-align: center; }
        .timer-input {
            width: 100%; background: transparent; border: none; color: var(--text-main);
            font-size: 1.4rem; font-weight: 700; text-align: center; outline: none;
        }
        .timer-sub { font-size: 0.6rem; color: var(--text-sub); font-weight: 700; margin-top: -3px; }
        .timer-sep { color: #b2bec3; font-weight: 700; font-size: 1.2rem; padding-bottom: 5px; }
        input[type="date"] { height: 56px; font-family: inherit; font-weight: 600; color: var(--text-main); }

        .action-btn { 
            width: 100%; padding: 18px; background: var(--text-main); color: white; 
            font-weight: 800; border: none; border-radius: 16px; cursor: pointer; 
            font-size: 1rem; text-transform: uppercase; margin-top: 10px; 
            box-shadow: 0 10px 20px rgba(0,0,0,0.1); 
        }
        .btn-danger { width: 100%; padding: 15px; background: #ffebeb; color: var(--danger); border: 1px solid #ffcece; border-radius: 14px; font-weight: 700; cursor: pointer; margin-top: 15px; }

        /* --- NAV --- */
        .page-view { display: none; animation: slideUp 0.3s ease; }
        .page-view.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        .back-pill { 
            display: inline-flex; align-items: center; gap: 10px; background: white; padding: 12px 26px; border-radius: 100px; cursor: pointer; margin-bottom: 35px; font-size: 0.9rem; color: var(--text-main); box-shadow: 0 5px 15px rgba(0,0,0,0.05); font-weight: 700;
        }
    </style>
</head>
<body>

<div id="menu-modal" class="modal-overlay">
    <div class="modal-box">
        <div class="modal-title">‚öôÔ∏è SETTINGS</div>
        
        <div style="text-align:center; margin-bottom:20px;">
            <span class="setting-label">DAILY CHAPTER LIMIT</span>
            <input type="number" id="daily-limit-input" class="limit-input" value="2" min="1">
        </div>

        <button class="action-btn" style="background:var(--success); margin-top:0;" onclick="saveSettings()">SAVE SETTINGS</button>
        <button class="btn-danger" onclick="resetData()">‚ö†Ô∏è RESET ALL DATA</button>
        <button class="btn-close" onclick="toggleMenu()">CLOSE MENU</button>
    </div>
</div>

<div class="container">

    <div id="dashboard" class="page-view active">
        
        <div class="header">
            <input type="text" class="app-title" value="NEET 2026" onchange="saveTitle(this.value)">
            <div class="header-actions">
                <div class="streak-pill"><span id="streak-val">0</span> üî•</div>
                <div class="menu-btn" onclick="toggleMenu()">‚ò∞</div>
            </div>
        </div>

        <div class="prog-container">
            <div class="prog-header"><span>Global Mastery</span><span id="global-perc">0%</span></div>
            <div class="bar-track"><div id="global-fill" class="bar-fill grad-global"></div></div>
        </div>

        <div class="countdown">
            <div style="font-size:0.75rem; font-weight:800; letter-spacing:3px; opacity:0.8; margin-bottom:12px;">EXAM COUNTDOWN</div>
            <div class="timer-grid">
                <div class="t-box"><span id="d" class="t-val">00</span><span class="t-lbl">DAYS</span></div>
                <div class="t-box"><span id="h" class="t-val">00</span><span class="t-lbl">HRS</span></div>
                <div class="t-box"><span id="m" class="t-val">00</span><span class="t-lbl">MIN</span></div>
                <div class="t-box"><span id="s" class="t-val">00</span><span class="t-lbl">SEC</span></div>
            </div>
        </div>

        <div class="pcb-grid">
            <div class="subject-card" onclick="openPage('roi')" style="align-items:center; justify-content:center; text-align:center; min-height:110px; padding-left:20px; background:#e6fcf5;">
                <div style="font-size:2rem; margin-bottom:5px;">üíé</div>
                <div style="font-weight:900; font-size:0.9rem; color:var(--success);">HACKS</div>
            </div>
            <div class="subject-card" onclick="openPage('priority-hub')" style="align-items:center; justify-content:center; text-align:center; min-height:110px; padding-left:20px; background:#fff0f0;">
                <div style="font-size:2rem; margin-bottom:5px;">üìä</div>
                <div style="font-weight:900; font-size:0.9rem; color:var(--danger);">PRIORITY</div>
            </div>
        </div>

        <div class="list-header">SUBJECT PROGRESS</div>
        <div class="pcb-grid">
            <div class="subject-card card-phy" onclick="openPage('phy')">
                <div class="sub-icon">‚ö°</div>
                <div>
                    <div class="sub-title">Physics</div>
                    <div class="tab-prog-track"><div id="bar-phy" class="bar-fill grad-phy"></div></div>
                </div>
            </div>
            <div class="subject-card card-chem" onclick="openPage('chem')">
                <div class="sub-icon">üß™</div>
                <div>
                    <div class="sub-title">Chemistry</div>
                    <div class="tab-prog-track"><div id="bar-chem" class="bar-fill grad-chem"></div></div>
                </div>
            </div>
            <div class="subject-card card-bio full-width" onclick="openPage('bio')">
                <div class="sub-icon">üß¨</div>
                <div class="sub-content" style="flex:1; margin-left:15px;">
                    <div class="sub-title">Biology</div>
                    <div class="tab-prog-track"><div id="bar-bio" class="bar-fill grad-bio"></div></div>
                </div>
            </div>
        </div>

        <div class="subject-card" style="min-height:auto; padding:25px; margin-bottom:20px; background:white;">
            <div style="font-weight:900; margin-bottom:15px; color:var(--text-sub); font-size:0.8rem; letter-spacing:1px; text-transform:uppercase;">Upcoming Tasks</div>
            <div id="dash-schedule"></div>
            <button class="action-btn" style="background:#f1f2f6; color:var(--text-main); margin-top:20px; font-size:0.9rem; box-shadow:none;" onclick="openPage('full-schedule')">View Full Schedule</button>
        </div>

    </div>

    <div id="full-schedule-page" class="page-view">
        <div class="back-pill" onclick="goHome()">‚Üê Dashboard</div>
        <h2 style="font-weight:900; margin-bottom:30px; font-size:2rem; color:var(--text-main);">Master Schedule</h2>
        <div id="full-schedule-list"></div>
    </div>

    <div id="priority-hub-page" class="page-view">
        <div class="back-pill" onclick="goHome()">‚Üê Dashboard</div>
        <h2 style="font-weight:900; margin-bottom:30px;">Priority Hub</h2>
        <div class="subject-card card-phy" style="min-height:90px; margin-bottom:15px; flex-direction:row; align-items:center;" onclick="openPriorityList('phy')"><span style="font-weight:bold;">Physics Priority</span></div>
        <div class="subject-card card-chem" style="min-height:90px; margin-bottom:15px; flex-direction:row; align-items:center;" onclick="openPriorityList('chem')"><span style="font-weight:bold;">Chemistry Priority</span></div>
        <div class="subject-card card-bio" style="min-height:90px; margin-bottom:15px; flex-direction:row; align-items:center;" onclick="openPriorityList('bio')"><span style="font-weight:bold;">Biology Priority</span></div>
    </div>

    <div id="priority-list-page" class="page-view">
        <div class="back-pill" onclick="openPage('priority-hub')">‚Üê Back</div>
        <h2 id="p-list-title" style="font-weight:900; margin-bottom:20px;">Priority List</h2>
        <div id="p-list-container"></div>
    </div>

    <div id="roi-page" class="page-view">
        <div class="back-pill" onclick="goHome()">‚Üê Dashboard</div>
        <h2 style="color:var(--success); margin-bottom:10px; font-weight:900;">üíé NEET Hacks</h2>
        <div id="roi-list-container"></div>
    </div>

    <div id="phy-page" class="page-view">
        <div class="back-pill" onclick="goHome()">‚Üê Dashboard</div>
        <div class="prog-container">
            <div class="prog-header"><span>Physics Progress</span><span id="page-perc-phy">0%</span></div>
            <div class="bar-track"><div id="page-bar-phy" class="bar-fill grad-phy"></div></div>
        </div>
        
        <div class="subject-card" style="min-height:auto; cursor:default; background:white; margin-bottom:25px;">
            <div style="font-weight:800; margin-bottom:15px; color:var(--phy);">Plan Chapter</div>
            <select id="phy-select"></select>
            
            <div class="widget-row">
                <div>
                    <span class="input-label">DURATION</span>
                    <div class="timer-container">
                        <div class="timer-part"><input type="number" id="phy-hr" class="timer-input" placeholder="00" min="0"><div class="timer-sub">HR</div></div>
                        <div class="timer-sep">:</div>
                        <div class="timer-part"><input type="number" id="phy-min" class="timer-input" placeholder="30" min="0" max="59"><div class="timer-sub">MIN</div></div>
                    </div>
                </div>
                <div>
                    <span class="input-label">DATE</span>
                    <input type="date" id="phy-date">
                </div>
            </div>

            <input type="text" id="phy-link" placeholder="üîó Paste Video Link (Optional)">
            <button class="action-btn" onclick="addTask('phy')">ADD TO SCHEDULE</button>
        </div>
        <div class="list-header">Active Schedule</div>
        <div id="phy-list"></div>
    </div>

    <div id="chem-page" class="page-view">
        <div class="back-pill" onclick="goHome()">‚Üê Dashboard</div>
        <div class="prog-container">
            <div class="prog-header"><span>Chemistry Progress</span><span id="page-perc-chem">0%</span></div>
            <div class="bar-track"><div id="page-bar-chem" class="bar-fill grad-chem"></div></div>
        </div>
        <div class="subject-card" style="min-height:auto; cursor:default; background:white; margin-bottom:25px;">
            <div style="font-weight:800; margin-bottom:15px; color:var(--chem);">Plan Chapter</div>
            <select id="chem-select"></select>
            <div class="widget-row">
                <div>
                    <span class="input-label">DURATION</span>
                    <div class="timer-container">
                        <div class="timer-part"><input type="number" id="chem-hr" class="timer-input" placeholder="00"><div class="timer-sub">HR</div></div>
                        <div class="timer-sep">:</div>
                        <div class="timer-part"><input type="number" id="chem-min" class="timer-input" placeholder="30"><div class="timer-sub">MIN</div></div>
                    </div>
                </div>
                <div><span class="input-label">DATE</span><input type="date" id="chem-date"></div>
            </div>
            <input type="text" id="chem-link" placeholder="üîó Paste Video Link">
            <button class="action-btn" onclick="addTask('chem')">ADD TO SCHEDULE</button>
        </div>
        <div id="chem-list"></div>
    </div>

    <div id="bio-page" class="page-view">
        <div class="back-pill" onclick="goHome()">‚Üê Dashboard</div>
        <div class="prog-container">
            <div class="prog-header"><span>Biology Progress</span><span id="page-perc-bio">0%</span></div>
            <div class="bar-track"><div id="page-bar-bio" class="bar-fill grad-bio"></div></div>
        </div>
        <div class="subject-card" style="min-height:auto; cursor:default; background:white; margin-bottom:25px;">
            <div style="font-weight:800; margin-bottom:15px; color:var(--bio);">Plan Chapter</div>
            <select id="bio-select"></select>
            <div class="widget-row">
                <div>
                    <span class="input-label">DURATION</span>
                    <div class="timer-container">
                        <div class="timer-part"><input type="number" id="bio-hr" class="timer-input" placeholder="00"><div class="timer-sub">HR</div></div>
                        <div class="timer-sep">:</div>
                        <div class="timer-part"><input type="number" id="bio-min" class="timer-input" placeholder="30"><div class="timer-sub">MIN</div></div>
                    </div>
                </div>
                <div><span class="input-label">DATE</span><input type="date" id="bio-date"></div>
            </div>
            <input type="text" id="bio-link" placeholder="üîó Paste Video Link">
            <button class="action-btn" onclick="addTask('bio')">ADD TO SCHEDULE</button>
        </div>
        <div id="bio-list"></div>
    </div>

</div>

<script>
    // --- CONFETTI HELPER ---
    function triggerConfetti() {
        if(window.confetti) {
            confetti({ particleCount: 150, spread: 80, origin:{y:0.6}, colors:['#00b894', '#0984e3', '#fdcb6e', '#e84393'] });
        }
    }

    const syllabusData = {
        phy: [
            {n:"Basic Mathematics",w:1},{n:"Vectors",w:1},{n:"Units & Measurements",w:1},
            {n:"Motion in Straight Line",w:1},{n:"Motion in Plane",w:2},{n:"Laws of Motion",w:2},
            {n:"Work, Energy, Power",w:2},{n:"Rotational Motion",w:3},{n:"Gravitation",w:2},
            {n:"Solids",w:1},{n:"Fluids",w:1},{n:"Thermal Props",w:1},{n:"Thermodynamics",w:2},
            {n:"Kinetic Theory",w:1},{n:"Oscillations",w:1},{n:"Waves",w:1},{n:"Electric Charges",w:3},
            {n:"Potential",w:2},{n:"Current Electricity",w:3},{n:"Moving Charges",w:2},{n:"Magnetism",w:1},
            {n:"EMI",w:2},{n:"AC",w:2},{n:"EM Waves",w:2},{n:"Ray Optics",w:3},{n:"Wave Optics",w:2},
            {n:"Dual Nature",w:2},{n:"Atoms",w:2},{n:"Nuclei",w:2},{n:"Semiconductors",w:3}
        ],
        chem: [
            {n:"Basic Concepts",w:1},{n:"Atom Structure",w:2},{n:"Periodic Table",w:2},{n:"Bonding",w:3},
            {n:"States of Matter",w:1},{n:"Thermodynamics",w:2},{n:"Equilibrium",w:3},{n:"Redox",w:1},
            {n:"Hydrogen",w:1},{n:"s-Block",w:2},{n:"p-Block (11)",w:2},{n:"Organic Basic",w:3},
            {n:"Hydrocarbons",w:2},{n:"Env Chem",w:1},{n:"Solid State",w:2},{n:"Solutions",w:2},
            {n:"Electrochemistry",w:2},{n:"Kinetics",w:2},{n:"Surface Chem",w:1},{n:"Metallurgy",w:1},
            {n:"p-Block (12)",w:2},{n:"d-f Block",w:2},{n:"Coordination",w:3},{n:"Haloalkanes",w:2},
            {n:"Alcohols",w:2},{n:"Aldehydes",w:3},{n:"Amines",w:2},{n:"Biomolecules",w:2},
            {n:"Polymers",w:1},{n:"Chem in Everyday",w:1}
        ],
        bio: [
            {n:"Living World",w:1},{n:"Classification",w:1},{n:"Plant Kingdom",w:2},{n:"Animal Kingdom",w:2},
            {n:"Morphology",w:2},{n:"Anatomy",w:2},{n:"Structural Org",w:2},{n:"Cell Unit",w:2},
            {n:"Biomolecules",w:2},{n:"Cell Cycle",w:2},{n:"Transport",w:1},{n:"Mineral",w:1},
            {n:"Photosynthesis",w:2},{n:"Respiration",w:1},{n:"Plant Growth",w:1},{n:"Digestion",w:2},
            {n:"Breathing",w:2},{n:"Body Fluids",w:2},{n:"Excretion",w:2},{n:"Locomotion",w:2},
            {n:"Neural",w:2},{n:"Chemical",w:2},{n:"Repro Organisms",w:1},{n:"Sex Repro Plants",w:3},
            {n:"Human Repro",w:3},{n:"Repro Health",w:2},{n:"Inheritance",w:3},{n:"Molecular",w:3},
            {n:"Evolution",w:2},{n:"Human Health",w:2},{n:"Food Strat",w:1},{n:"Microbes",w:1},
            {n:"Biotech Prin",w:3},{n:"Biotech App",w:3},{n:"Organisms",w:2},{n:"Ecosystem",w:2},
            {n:"Biodiversity",w:2},{n:"Env Issues",w:2}
        ]
    };

    let scheduled = { phy: [], chem: [], bio: [] };
    let streak = 0, lastActive = "";
    let dailyLimit = 2; // Default Limit

    window.addEventListener('DOMContentLoaded', init);

    function init() {
        try {
            const saved = localStorage.getItem('neet_ultra_v24');
            if (saved) {
                const parsed = JSON.parse(saved);
                scheduled = parsed.scheduled || scheduled;
                streak = parsed.streak || 0;
                lastActive = parsed.lastActive || "";
                dailyLimit = parsed.dailyLimit || 2;
                document.querySelector('.app-title').value = parsed.title || "NEET 2026";
                document.getElementById('daily-limit-input').value = dailyLimit;
            }
        } catch(e) {}
        checkStreak();
        updateUI();
    }

    function saveData() {
        const title = document.querySelector('.app-title').value;
        localStorage.setItem('neet_ultra_v24', JSON.stringify({ scheduled, streak, lastActive, title, dailyLimit }));
        updateUI();
    }

    function saveTitle(val) { saveData(); }
    
    function resetData() { 
        if(confirm("Are you sure? This will wipe all data.")) { 
            localStorage.clear(); location.reload(); 
        } 
    }

    function toggleMenu() {
        const modal = document.getElementById('menu-modal');
        modal.classList.toggle('open');
    }

    function saveSettings() {
        const val = document.getElementById('daily-limit-input').value;
        dailyLimit = parseInt(val) > 0 ? parseInt(val) : 2;
        saveData();
        toggleMenu(); // Close after saving
    }

    function checkStreak() {
        const today = new Date().toDateString();
        if (lastActive !== today) {
            const yesterday = new Date(); yesterday.setDate(yesterday.getDate() - 1);
            if (lastActive !== yesterday.toDateString()) streak = 0;
        }
        document.querySelector('.streak-pill').innerHTML = `${streak} üî•`;
    }

    function updateStreak() {
        const today = new Date().toDateString();
        if (lastActive !== today) {
            const yesterday = new Date(); yesterday.setDate(yesterday.getDate() - 1);
            if (lastActive === yesterday.toDateString()) streak++; else streak = 1;
            lastActive = today;
        }
        saveData();
    }

    function validateDate(date) {
        let count = 0;
        ['phy','chem','bio'].forEach(s => {
            scheduled[s].forEach(task => { if(task.date === date && !task.done) count++; });
        });
        if(count >= dailyLimit) {
            alert(`‚ö†Ô∏è Limit Reached: Max ${dailyLimit} chapters per day! Increase limit in menu.`);
            return false;
        }
        return true;
    }

    function updateUI() {
        let totalCh = 0, totalDone = 0;
        ['phy','chem','bio'].forEach(sub => {
            const total = syllabusData[sub].length;
            const done = scheduled[sub].filter(t => t.done).length;
            const perc = total===0?0:Math.round((done/total)*100);
            
            if(document.getElementById(`bar-${sub}`)) document.getElementById(`bar-${sub}`).style.width = `${perc}%`;
            if(document.getElementById(`page-perc-${sub}`)) document.getElementById(`page-perc-${sub}`).innerText = `${perc}%`;
            if(document.getElementById(`page-bar-${sub}`)) document.getElementById(`page-bar-${sub}`).style.width = `${perc}%`;
            
            totalCh += total; totalDone += done;
        });
        const gPerc = totalCh===0?0:Math.round((totalDone/totalCh)*100);
        document.getElementById('global-fill').style.width = `${gPerc}%`;
        document.getElementById('global-perc').innerText = `${gPerc}%`;
        document.querySelector('.streak-pill').innerHTML = `${streak} üî•`;
        renderDashSchedule();
    }

    function renderDashSchedule() {
        const el = document.getElementById('dash-schedule');
        el.innerHTML = "";
        let all = [];
        ['phy','chem','bio'].forEach(s => scheduled[s].forEach(t => all.push({...t, sub:s})));
        all.sort((a,b) => {
            if (a.done === b.done) return new Date(a.date) - new Date(b.date);
            return a.done ? 1 : -1;
        });

        const displayList = all.slice(0, 5);

        if(displayList.length === 0) el.innerHTML = "<div style='text-align:center; color:#999; padding:15px;'>No tasks found. Add one!</div>";
        else displayList.forEach(t => {
            let check = `<div class="checkbox ${t.done?'checked':''}" onclick="quickToggle('${t.sub}', '${t.chapter.replace(/'/g, "\\'")}')"></div>`;
            let linkHtml = t.link ? `<a href="${t.link}" target="_blank" class="play-link">‚ñ∂</a>` : '';
            el.innerHTML += `
                <div class="task-item">
                    <div style="display:flex; align-items:center;">
                        ${check}
                        <div>
                            <div style="font-weight:800; font-size:0.95rem; ${t.done?'text-decoration:line-through; color:#aaa':''}">${t.chapter}</div>
                            <div style="font-size:0.75rem; color:#636e72;">${t.sub.toUpperCase()} ‚Ä¢ ${t.date}</div>
                        </div>
                    </div>
                    ${linkHtml}
                </div>`;
        });
    }

    function renderFullSchedule() {
        const el = document.getElementById('full-schedule-list');
        el.innerHTML = "";
        let all = [];
        ['phy','chem','bio'].forEach(s => scheduled[s].forEach(t => all.push({...t, sub:s})));
        all.sort((a,b) => {
            if (a.done === b.done) return new Date(a.date) - new Date(b.date);
            return a.done ? 1 : -1;
        });

        if(all.length === 0) el.innerHTML = "<div style='text-align:center; color:#999; padding:20px;'>No schedule yet.</div>";
        else all.forEach(t => {
            let check = `<div class="checkbox ${t.done?'checked':''}" onclick="quickToggle('${t.sub}', '${t.chapter.replace(/'/g, "\\'")}')"></div>`;
            let linkHtml = t.link ? `<a href="${t.link}" target="_blank" class="play-link">‚ñ∂</a>` : '';
            el.innerHTML += `
                <div class="task-item">
                    <div style="display:flex; align-items:center;">
                        ${check}
                        <div>
                            <div style="font-weight:800; font-size:0.95rem; ${t.done?'text-decoration:line-through; color:#aaa':''}">${t.chapter}</div>
                            <div style="font-size:0.75rem; color:#636e72;">${t.sub.toUpperCase()} ‚Ä¢ ${t.date} ‚Ä¢ ${t.time}</div>
                        </div>
                    </div>
                    ${linkHtml}
                </div>`;
        });
    }

    function renderSubjectPage(sub) {
        const sel = document.getElementById(`${sub}-select`);
        const plannedNames = scheduled[sub].map(t => t.chapter);
        const available = syllabusData[sub].filter(c => !plannedNames.includes(c.n));
        sel.innerHTML = '<option value="">Select Chapter</option>';
        available.forEach(c => { let o = document.createElement('option'); o.value=c.n; o.text=c.n; sel.add(o); });

        const list = document.getElementById(`${sub}-list`);
        list.innerHTML = "";
        
        scheduled[sub].sort((a,b) => new Date(a.date) - new Date(b.date));
        scheduled[sub].forEach((t, i) => {
            let check = `<div class="checkbox ${t.done?'checked':''}" onclick="toggleTask('${sub}', ${i})"></div>`;
            let linkHtml = t.link ? `<a href="${t.link}" target="_blank" class="play-link">‚ñ∂</a>` : '';
            list.innerHTML += `
                <div class="task-item">
                    <div style="display:flex; align-items:center;">
                        ${check}
                        <div>
                            <div style="font-weight:800; ${t.done?'text-decoration:line-through; color:#aaa':''}">${t.chapter}</div>
                            <div style="font-size:0.75rem; color:#636e72; opacity:0.8;">üìÖ ${t.date} ‚Ä¢ ‚è± ${t.time}</div>
                        </div>
                    </div>
                    <div style="display:flex; align-items:center;">
                        ${linkHtml}
                        <button style="background:transparent; border:none; color:#b2bec3; font-size:1.2rem; cursor:pointer; margin-left:15px;" onclick="delTask('${sub}',${i})">√ó</button>
                    </div>
                </div>`;
        });
    }

    function addTask(sub) {
        const c = document.getElementById(`${sub}-select`).value;
        const d = document.getElementById(`${sub}-date`).value;
        const l = document.getElementById(`${sub}-link`).value;
        
        const hr = document.getElementById(`${sub}-hr`).value || '0';
        const min = document.getElementById(`${sub}-min`).value || '00';
        const t = `${hr}h ${min}m`;

        if(!c || !d) return alert("Select chapter and date.");
        if(!validateDate(d)) return;

        scheduled[sub].push({chapter:c, date:d, time:t, link:l, done:false});
        saveData(); 
        renderSubjectPage(sub);
        
        document.getElementById(`${sub}-select`).value = "";
        document.getElementById(`${sub}-date`).value = "";
        document.getElementById(`${sub}-link`).value = "";
        document.getElementById(`${sub}-hr`).value = "";
        document.getElementById(`${sub}-min`).value = "";
    }

    function toggleTask(sub, i) {
        const isNowDone = !scheduled[sub][i].done;
        scheduled[sub][i].done = isNowDone;
        if(isNowDone) { updateStreak(); triggerConfetti(); }
        saveData(); 
        renderSubjectPage(sub);
    }

    function quickToggle(sub, name) {
        const idx = scheduled[sub].findIndex(t => t.chapter === name);
        if(idx > -1) {
            const isNowDone = !scheduled[sub][idx].done;
            scheduled[sub][idx].done = isNowDone;
            if(isNowDone) { updateStreak(); triggerConfetti(); }
            saveData();
            if(document.getElementById('roi-page').style.display === 'block') renderRoiList();
            else if(document.getElementById('priority-list-page').style.display === 'block') {
                let title = document.getElementById('p-list-title').innerText;
                if(title.includes('Physics')) renderPriorityList('phy');
                else if(title.includes('Chemistry')) renderPriorityList('chem');
                else if(title.includes('Biology')) renderPriorityList('bio');
            } else if(document.getElementById('full-schedule-page').style.display === 'block') {
                renderFullSchedule();
            } else updateUI();
        } else {
            const today = new Date().toISOString().split('T')[0];
            scheduled[sub].push({chapter:name, date:today, time:'2h', link:'', done:true});
            updateStreak(); triggerConfetti();
            if(document.getElementById('roi-page').style.display === 'block') renderRoiList();
            else {
                let title = document.getElementById('p-list-title').innerText;
                if(title.includes('Physics')) renderPriorityList('phy');
                else if(title.includes('Chemistry')) renderPriorityList('chem');
                else if(title.includes('Biology')) renderPriorityList('bio');
            }
        }
    }

    function delTask(sub, i) {
        scheduled[sub].splice(i,1);
        saveData();
        renderSubjectPage(sub);
    }

    function renderRoiList() {
        const el = document.getElementById('roi-list-container');
        el.innerHTML = "";
        let titles = {phy:"Physics", chem:"Chemistry", bio:"Biology"};
        for(let sub in titles) {
            let has=false;
            let html = `<div class="list-header" style="color:var(--success); border-color:var(--success);">${titles[sub]}</div>`;
            syllabusData[sub].forEach(ch => {
                if(ch.w >= 2) { 
                    has=true;
                    const task = scheduled[sub].find(t => t.chapter === ch.n);
                    const isDone = task && task.done;
                    let check = `<div class="checkbox ${isDone?'checked':''}" onclick="quickToggle('${sub}', '${ch.n.replace(/'/g, "\\'")}')"></div>`;
                    let linkHtml = (task && task.link) ? `<a href="${task.link}" target="_blank" class="play-link">‚ñ∂</a>` : '';
                    html += `<div class="task-item"><div style="display:flex; align-items:center;">${check}<div><div style="font-weight:700; ${isDone?'text-decoration:line-through; color:#aaa':''}">${ch.n}</div><div style="margin-top:4px;"><span class="tag tag-high">HIGH</span> <span class="tag tag-fast">FAST</span></div></div></div>${linkHtml}</div>`;
                }
            });
            if(has) el.innerHTML += html;
        }
    }

    function renderPriorityList(sub) {
        const el = document.getElementById('p-list-container');
        el.innerHTML = "";
        let tiers = {3:"Tier 1: Critical", 2:"Tier 2: Essential", 1:"Tier 3: Standard"};
        let chapters = [...syllabusData[sub]].sort((a,b) => b.w - a.w);
        let curW = -1;
        chapters.forEach(ch => {
            if(ch.w !== curW) { curW = ch.w; el.innerHTML += `<div class="list-header">${tiers[curW]}</div>`; }
            const task = scheduled[sub].find(t => t.chapter === ch.n);
            const isDone = task && task.done;
            let check = `<div class="checkbox ${isDone?'checked':''}" onclick="quickToggle('${sub}', '${ch.n.replace(/'/g, "\\'")}')"></div>`;
            let linkHtml = (task && task.link) ? `<a href="${task.link}" target="_blank" class="play-link">‚ñ∂</a>` : '';
            el.innerHTML += `<div class="task-item"><div style="display:flex; align-items:center;">${check}<span>${ch.n}</span></div>${linkHtml}</div>`;
        });
    }

    function goHome() { openPage('dashboard'); }
    function openPage(id) {
        document.querySelectorAll('.page-view').forEach(e => e.classList.remove('active'));
        const map = {'priority-hub':'priority-hub-page','roi':'roi-page','phy':'phy-page','chem':'chem-page','bio':'bio-page','full-schedule':'full-schedule-page'};
        const pid = map[id] || id;
        document.getElementById(pid).classList.add('active');
        if(['phy','chem','bio'].includes(id)) renderSubjectPage(id);
        if(id === 'roi') renderRoiList();
        if(id === 'full-schedule') renderFullSchedule();
    }
    function openPriorityList(sub) {
        document.querySelectorAll('.page-view').forEach(e => e.classList.remove('active'));
        document.getElementById('priority-list-page').classList.add('active');
        const names = {phy:'Physics', chem:'Chemistry', bio:'Biology'};
        document.getElementById('p-list-title').innerText = `${names[sub]} Priority`;
        renderPriorityList(sub);
    }

    setInterval(() => {
        const target = new Date(new Date().getFullYear(), 4, 3);
        if(new Date() > target) target.setFullYear(target.getFullYear()+1);
        const diff = target - new Date();
        document.getElementById('d').innerText = Math.floor(diff/(1000*60*60*24));
        document.getElementById('h').innerText = Math.floor((diff%(1000*60*60*24))/(1000*60*60));
        document.getElementById('m').innerText = Math.floor((diff%(1000*60*60))/(1000*60));
        document.getElementById('s').innerText = Math.floor((diff%(1000*60))/1000);
    }, 1000);

    init();
</script>
</body>
</html>